{% extends "layout.html" %}
{% block title %}íœ´ê°€ ëª©ë¡{% endblock %}

{% block content %}
<h1>ğŸ“ íœ´ê°€ ëª©ë¡</h1>

<div>
    <a href="{{ url_for('main.leave_list', view='pending') }}"
       {% if view == 'pending' %}style="font-weight:bold"{% endif %}>
       ìŠ¹ì¸ëŒ€ê¸°
    </a> |

    <a href="{{ url_for('main.leave_list', view='week') }}"
       {% if view == 'week' %}style="font-weight:bold"{% endif %}>
       ì´ë²ˆ ì£¼
    </a> |

    <a href="{{ url_for('main.leave_list', view='month') }}"
       {% if view == 'month' %}style="font-weight:bold"{% endif %}>
       ì´ë²ˆ ë‹¬
    </a> |

    <a href="{{ url_for('main.leave_list', view='year') }}"
       {% if view == 'year' %}style="font-weight:bold"{% endif %}>
       ì˜¬í•´
    </a>
</div>


<p>ë³´ê¸° ë‹¨ìœ„: {{ view }}</p>

<table>
<tr>
    <th>ì§ì›</th><th>ê¸°ê°„</th><th>ì¼ìˆ˜</th><th>ì‚¬ìœ </th><th>ìŠ¹ì¸ì—¬ë¶€</th>
    <th>ì‹ ì²­ ê°€ëŠ¥ ì—°ì°¨</th><th>ë‚¨ì€ ì—°ì°¨ (ì—°ë„ë³„)</th><th>ì‘ì—…</th>
</tr>
{% for leave in leaves %}
<tr>
    <td>{{ leave.user.name }}</td>
    <td>{{ leave.start_date }} ~ {{ leave.end_date }}</td>
    <td>{{ leave.days }}</td>
    <td>{{ leave.reason }}</td>
    <td>
    {% if leave.status == "Pending" %}
        <form method="POST" action="{{ url_for('main.approve_leave', leave_id=leave.id) }}" style="display:inline">
            <button>âœ… ìŠ¹ì¸</button>
        </form>
        <form method="POST" action="{{ url_for('main.reject_leave', leave_id=leave.id) }}" style="display:inline">
            <button>âŒ ë°˜ë ¤</button>
        </form>
    {% else %}
        {{ leave.status }}
    {% endif %}
    </td>
    <td>
    {% for year, days in leave.user.requestable_leave_by_year.items() %}
        {{ year }}ë…„: {{ days }}ì¼ ì‹ ì²­ ê°€ëŠ¥<br>
    {% else %}
        ì‹ ì²­ ê°€ëŠ¥ ì—°ì°¨ ì—†ìŒ
    {% endfor %}
    </td>
    <td>
        {% for year, remaining in leave.user.remaining_leave_by_year.items() %}
            {{ year }}: {{ remaining }}<br>
        {% endfor %}
    </td>
    <td>
        <a href="/leaves/{{ leave.id }}/edit?view_unit={{ request.args.get('view_unit', 'week') }}">âœï¸</a>
        <form method="POST" action="/leaves/{{ leave.id }}/delete" style="display:inline">
            <input type="hidden" name="view_unit" value="{{ request.args.get('view_unit', 'week') }}">
            <button onclick="return confirm('ì‚­ì œ?')">ğŸ—‘ï¸</button>
        </form>
    </td>
</tr>
{% endfor %}
</table>
{% endblock %}
